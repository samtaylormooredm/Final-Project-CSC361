<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <!-- Responsive design to improve mobile accessibility -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <title>Climate Concern Choropleth</title>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/7.2.0/introjs.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<!-- Intro.Js Tour -->
<div id="welcome-modal" alt="An introduction to the visualization; you can tab through this introduction" style="display:none; position: fixed; top: 30%; left: 50%; transform: translate(-50%, -50%);
background: white; border: 1px solid #ccc; padding: 20px; z-index: 9999; box-shadow: 0 2px 10px rgba(0,0,0,0.2);">
<h3>Welcome!</h3>
<p>Our visualization maps the percentage of individuals in each state in the US that reported being worried about global warming over the years 2010-2024. Click below to start your tour of the visualization!</p>
<button id="start-tour-btn" style="margin-top: 10px;">Start Tour</button>
</div>
  <!-- Title and instructions -->
  <div class="title-container">
    <h1>Estimated % of adults who are worried about global warming</h1>
    <!-- <p>
      Click and slide over the slider to see a map of each year. Click 
      <span class="play-icon">▶</span> to see an animation of the state populations' opinions over time. 
      Hover over each state to see a chart of the population's opinion over time.
    </p> -->
  </div>

  <!-- Controls (Slider + Label + Play) -->
  <div class="controls">
    <div id="year-label">Year: </div>
    <div class="slider-container">
      <input type="range" aria-label="year-slider" id="year-slider" alt="A slider that allows the user to click and slide over the slider to see a map of each year" data-intro="Click and slide over the slider to see a map of each year." data-title="Year Selector" data-step="1">
      <button id="play-button" data-title="Play Button" data-intro="Click here to see an animation of the state populations' opinions over time." data-step="2">▶ Play</button>
    </div>
    <div id="slider-ticks"></div>
    </div>
  </div>

  <!-- Map and Chart Layout -->
  <div class="map-chart-wrapper" style="display: flex; flex-wrap: wrap;">
    <div id="map-container" 
    style="flex: 1 1 50%; min-width: 300px; height: auto;"
    alt="A map that highlights the percentage of each state's reported worries about global warming for that year. Each state grows increasingly darker with the year."
    data-title="A map comparing the population of worried individuals in each state"
    data-intro="Hover over any state to see its data. Click a state to view its trend."
    data-step="3">
    
      <svg id="map" viewBox="0 0 800 500" preserveAspectRatio="xMidYMid meet" style="width: 100%; height: auto;">
        <defs>
          <!-- Softer glow for hover -->
          <filter id="hover-glow">
            <feDropShadow dx="0" dy="0" stdDeviation="2" flood-color="#FFFFED" flood-opacity="0.8"/>
          </filter>
        
          <!-- Stronger glow for selected state -->
          <filter id="selected-glow">
            <feDropShadow dx="0" dy="0" stdDeviation="3" flood-color="#FFD700" flood-opacity="1"/>
          </filter>
        </defs>
      </svg>
    </div>
    <div id="legend-wrapper" alt="A color legend that ranges from 40% to 75%, indicating the percentage of folks who reported being worried in that state"
    style="flex: 1 1 15%; min-width: 150px; display: flex; flex-direction: column; align-items: center; gap: 10px;"
    data-title="Color Legend"
    data-intro="These color bins represent percentage ranges of worried individuals. Click to filter."
    data-step="4">

 <div id="legend-container">
   <!-- D3 appends the legend SVG here -->
 </div>

 <button id="clear-filters-button"
         disabled
         style="cursor: not-allowed; padding: 10px 16px; font-size: 16px;">
   Clear All Filters
 </button>
</div>

<div id="line-chart-container"
alt="This is a line chart that compares the selected state's percentage of worried citizens over 2010-2024"
    style="flex: 1 1 100%; margin-top: 20px;"
    data-title="Trend View"
    data-intro="Clicking a state shows its opinion trend here over time. Hover over the dots to see the percentage."
    data-step="5">
 <!-- Line chart renders here -->
</div>

</div>
  <h2 class="sr-only">Map Summary: This choropleth shows the percentage of adults concerned about climate change by state and year. Darker states represent higher concern.</h2>

  <h2 class="sr-only">Line Chart Summary: This line chart shows how concern about climate change changes over time for a selected state.</h2>

  <a class="sr-only" href="./data.html" title="An HTML page with all the information in the dataset">
    <img src="image.jpg" alt="An HTML page with all the information in the dataset" />
  </a>

  <!-- Tooltip -->
  <div class="tooltip" id="tooltip"></div>

  <!-- Main script -->
  <script src="main.js"></script>

  <div id="popup-warning" style="
  display: none;
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background-color: #ffefc5;
  color: #333;
  padding: 10px 18px;
  border: 1px solid #e0c177;
  border-radius: 6px;
  font-size: 15px;
  z-index: 1000;
  box-shadow: 0px 2px 8px rgba(0,0,0,0.15);
  transition: opacity 0.3s ease;
">
  Pause animation to select a state.
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/7.2.0/intro.min.js"></script>
</body>
</html>